\section{MIB Controller}
	MIB controller is the bridge between control unit and FU network. It establishes communication for both control and status signals, where the former is routed from controller to target and latter is from target to controller, both unidirectionally. Table \ref{table:mib_description} describes input/output ports.  
	
	
	
	\begin{table}[htbp]
		\begin{tabular}{| l| l | l | p{9cm} |}
			\hline
			\textbf{name} & \textbf{direction} & \textbf{type} &  \textbf{description}\\ \hline
			ctrl & input & mib\_ctrl\_out & control packet from controller. \emph{dest.fu} signal is used to select target. ctrl signal is steered to destination port without modification. \\ \hline
			stat & output & mib\_stalls & status packet from target. \emph{dest.fu} signal of \emph{ctrl} determines the address of target in which its status to be read.  \\ \hline
			mib\_ctrl & output & mib\_ctrl\_bus & control signal group. Every FU in network is connected to the bus in ascending order of their addresses.   \\ \hline
			mib\_stat & input & mib\_status\_bus & status signal group. Status output of FUs in network is connected through corresponding signal   \\ \hline
			
		\end{tabular}
		
		\caption{MIB ports \label{table:mib_description}}
		\centering
	\end{table}
	 
	
	Assuming target address $N$, Figures \ref{fig:ctrl_to_target} and \ref{fig:status_from_target} illustrate control and status packet transfers from controller to target, and from target to controller, respectively. Since availability of both source and destination is checked by controller before performing control operations, packet is held at the bus for a cycle duration only. 
	
	\begin{figure}[!hbp]
	\centering
	\subfloat[Control packet to target] {
			\begin{tikztimingtable}[timing/lslope=0]
				clk & 14{C} \\
				ctrl.valid & 3L2H9L \\
				ctrl.dest & 3X8D{$N$}3X \\
				ctrl.phase & 3X8D{COMMIT}3X \\
				mib\_ctrl[$N$] & 5X2D{ctrl}7X \\
				mib\_ctrl.valid[$N$] & 5L2H7L \\
			\end{tikztimingtable}
			\label{fig:ctrl_to_target}
		}
			%\caption{Control packet to target}
			%\centering
%	\end{subfloat}
	\hfill
	\subfloat[Status packet from target] {
			\begin{tikztimingtable}[timing/lslope=0]
				clk & 14{C} \\
				ctrl.valid & 3L2H9L \\
				ctrl.dest & 3X8D{$N$}3X \\
				ctrl.phase & 3X8D{CHECK}3X \\
				mib\_stat[$N$] & 5X2D7X \\
			\end{tikztimingtable}
			\label{fig:status_from_target} 
		}
			%\caption{Status packet from target}
			%\centering
	
	\caption{Control and status packet transfer}
	\end{figure}
	
		Design is straightforward, consisting of $1\times\nrFUS$ de-multiplexer for controller to network routing and $\nrFUS\times 1$ multiplexer for opposite direction. Target functional unit is selected by destination address field of MIB control input, regardless of the operation type.  Due to lack of tri-state ic in FPGA fabric to be used, there is many-to-one relationship for status signals between functional units and control unit. Output of every unit is encoded in bus controller using destination address from control unit as line select. However, the opposite is not necessarily true, since a single line from controller for control packages can be snooped by functional units. For simplicity, we prefer using separate lines for control messages as well, by steering packet from controller to target line using destination address as line select. Bus snooping for control messages will be featured after validating main functionality. Figure \ref{fig:mib} shows structure of bus controller.
	\begin{figure}[htbp]
		\centering
		\def\svgscale{0.50}
		\input{figures/mib.pdf_tex}
		\caption{MIB structure}
		\label{fig:mib} 
	\end{figure}